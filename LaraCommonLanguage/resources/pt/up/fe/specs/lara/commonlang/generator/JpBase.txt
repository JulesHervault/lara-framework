/**
 * Base class for all LARA join points.
 *
 * @class
 */
 
function JoinPoint(astNode) {
	this.astNode = astNode;
}

JoinPoint.prototype.instanceOf = function(joinPointType) {
	return joinPointType === this.joinPointType;
}

JoinPoint.prototype.sameTypeAs = function(joinPoint) {
    if(typeof joinPoint !== typeof this)
        return false;
        
	if(joinPoint.joinPointType !== this.joinPointType)
        return false;
	
	return true;    
}

JoinPoint.prototype.toString = function() {
	return "CommonJp<" + this.joinPointType + ">";
}

_lara_dummy_ = Object.defineProperty(JoinPoint.prototype, 'joinPointType', {
	configurable: true,
	get: function () { return 'joinpoint'; }
});

_lara_dummy_ = Object.defineProperty(JoinPoint.prototype, 'parent', {
	configurable: true,
	get: function () { 
		return (new JoinPoints()).getParent(this);
	}
});

_lara_dummy_ = Object.defineProperty(JoinPoint.prototype, 'children', {
	configurable: true,
	get: function () {
		return (new JoinPoints()).getChildren(this); 
	}
});

_lara_dummy_ = Object.defineProperty(JoinPoint.prototype, 'descendants', {
	configurable: true,
	get: function () {
		accum = [];
	    for(child of this.children){
	    	accum.push(child);
	    	accum = accum.concat(child.descendants);
	    }
		return accum;
	}
});

JoinPoint.prototype.ancestor = function(type) {

	var ancestor = this.parent;
	
	while(ancestor!== null && !ancestor.instanceOf(type)){
		println(ancestor);
		println(ancestor.astNode.getClass().getSimpleName());
		ancestor=ancestor.parent;
		println("error");	
	}

	return ancestor;    
}

_lara_dummy_ = Object.defineProperty(JoinPoint.prototype, 'hasChildren', {
	configurable: true,
	get: function () {
		return this.children && this.children.length > 0; 
	}
});




